---
title: "Assignment 3"
author: "Steven Tran"
date: "February 7, 2018"
output: pdf_document
---

```{R}
## Reading in Data
BP2010 <- read.csv("BP Apprehensions 2010.csv", header = TRUE, stringsAsFactors = FALSE)
PB2017 <- read.csv("PB Apprehensions 2017.csv", header = TRUE, stringsAsFactors = TRUE)
PBmonthly <- read.csv("monthly_sum.csv", header = TRUE, stringsAsFactors = TRUE)
rownames(PBmonthly) <- PBmonthly[,1]

## Displaying Data By Sector
rownames(BP2010) <- BP2010[,1]
x <- barplot(BP2010[1:9,13], names.arg = rownames(BP2010)[1:9],
        las=2,
        axisnames=TRUE,
        main="2010 Border Patrol Apprehensions by Sector",
        border="blue",
        col="yellow")

rownames(PB2017) <- PB2017[,1]
barplot(PB2017[1:9,13], names.arg = rownames(PB2017)[1:9],
        las=2,
        axisnames=TRUE,
        main="2017 Border Patrol Apprehensions by Sector",
        border="blue",
        col="yellow")

##Display Data By Year
barplot(PBmonthly[1:9,13], names.arg = rownames(PBmonthly)[1:9],
        las=2,
        axisnames=TRUE,
        main="2010 Border Patrol Apprehensions by Year",
        border="blue",
        col="yellow")

## T-test for Max in 2010 (Tucson) and Max in 2017 (Rio Grande Valley)
x <- subset(BP2010, select=-c(Sector))
x <- cbind(x,rowSums(x))
x <- t(x)
y <- subset(PB2017, select=-c(Sector))
y <- cbind(y,rowSums(y))
y <- t(y)
t.test(x[,8], y[,6])

## Creates a 2 x 9 matrix from the 2010 data and 2017 for specified month
sideBySideMatrix <- function(month){
  matrix(c(BP2010[1:9,month], PB2017[1:9,month]), nrow = 2, byrow = TRUE)
}

## Creates the barplot for a given month
sideBySideBarPlot <- function(month, monthString){
  barplot(sideBySideMatrix(month), names.arg = rownames(BP2010),
          las=2,
          axisnames=TRUE,
          beside=TRUE,
          col=c("blue", "red"),
          main = paste("2010 vs 2017 Border Patrol Apprehensions in", monthString, sep=" "))
  legend("topleft", 
       c("2010", "2017"), 
       fill = c("blue", "red"))
}

## Creates the side by side bar plots for each month
sideBySideBarPlot(2, "October")
sideBySideBarPlot(3, "November")
sideBySideBarPlot(4, "December")
sideBySideBarPlot(5, "January")
sideBySideBarPlot(6, "February")
sideBySideBarPlot(7, "March")
sideBySideBarPlot(8, "April")
sideBySideBarPlot(9, "June")
sideBySideBarPlot(10, "July")
sideBySideBarPlot(11, "August")
sideBySideBarPlot(12, "September")

x1 <- data.frame(sideBySideMatrix(2))
x1 <- cbind(data.frame(matrix =c(2010, 2017), nrow = 2, byrow = TRUE), x1)
x1 <- as.factor(t(x))
y1 <- ts(rev(x), start = 1, frequency = 12)
ts.plot(y1)


x <- as.vector(t(PBmonthly))
y <- ts(rev(x), start = c(2000, 10), frequency = 12)
ts.plot(y, gpars=list(xlab="year", ylab="Apprehensions", lty=c(1:3)))
```